kogen build kogen.cue
cmp stdout golden.yaml

-- kogen.cue --
package kube

kogen: app: {
    apiVersion: "kogen.internal/v1alpha1"
    kind: "Objects"
    spec: objects: [
        {
            apiVersion: "v1"
            kind: "ConfigMap"
            metadata: {
                name: "app-config"
                namespace: "default"
            }
            data: {
                database_url: "postgresql://localhost:5432/app"
                redis_url: "redis://localhost:6379"
            }
        },
        {
            apiVersion: "v1"
            kind: "Secret"
            metadata: {
                name: "app-secrets"
                namespace: "default"
            }
            type: "Opaque"
            data: {
                password: "c2VjcmV0"
            }
        },
        {
            apiVersion: "apps/v1"
            kind: "Deployment"
            metadata: {
                name: "app"
                namespace: "default"
            }
            spec: {
                replicas: 3
                selector: matchLabels: app: "myapp"
                template: {
                    metadata: labels: app: "myapp"
                    spec: containers: [{
                        name: "app"
                        image: "nginx:1.21"
                        ports: [{
                            containerPort: 80
                        }]
                    }]
                }
            }
        }
    ]
}

-- golden.yaml --
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
data:
  database_url: postgresql://localhost:5432/app
  redis_url: redis://localhost:6379
---
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: default
type: Opaque
data:
  password: c2VjcmV0
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
        - name: app
          image: nginx:1.21
          ports:
            - containerPort: 80
